<!DOCTYPE html>
<html>
  
  <head>
    <meta charset="UTF-8">
    <title>添加管理员-WeAdmin Frame型后台管理系统-WeAdmin 1.0</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <link rel="stylesheet" href="/css/font.css">
    <link rel="stylesheet" href="/css/weadmin.css">
    <style>
        .emp-hight{margin-bottom: 8px;}
    </style>
  </head>
  
  <body>
    <div class="weadmin-body">
        <form class="layui-form">
            <div class="layui-form-item emp-hight">
                <label class="layui-form-label">账户名</label>
                <div class="layui-input-inline">
                    <input type="tel" name="userAccunt" id="userAccunt" lay-verify="userAccunt" autocomplete="off" class="layui-input">
                    <input type="hidden" name="userId" id="userId"  class="layui-input">
                </div>
            </div>

            <div class="layui-form-item emp-hight">
                <label class="layui-form-label">姓名</label>
                <div class="layui-input-inline">
                    <input type="tel" name="userName" id="userName" lay-verify="userName" autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-form-item emp-hight" pane="">
                <label class="layui-form-label">角色等级</label>
                <div class="layui-input-block roleId"  id="roleId">
                    <input type="radio" name="roleId" value="1" title="系统管理员" checked="">
                    <input type="radio" name="roleId" value="2" title="部门管理员">
                    <input type="radio" name="roleId" value="3" title="普通员工" >
                </div>
            </div>

            <div class="layui-form-item emp-hight">
                <div class="layui-inline">
                    <label class="layui-form-label">选择部门</label>
                    <div class="layui-input-inline">
                        <select name="deptId" id="deptId"  lay-verify="deptId" lay-search="">
                            <option value="">请选择部门</option>
                            <option value="1">市场部</option>
                            <option value="2">运营部</option>
                            <option value="3">财务部</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="layui-form-item emp-hight">
                <label class="layui-form-label">手机号</label>
                <div class="layui-input-inline">
                    <input type="tel" name="phone" id="phone" lay-verify="phone" autocomplete="off" class="layui-input">
                </div>
            </div>

            <div class="layui-form-item emp-hight">
                <label class="layui-form-label">邮箱</label>
                <div class="layui-input-inline">
                    <input type="text" name="email"  id="email" lay-verify="email" autocomplete="off" class="layui-input">
                </div>
            </div>

            <div class="layui-form-item emp-hight" id="password">
                <label class="layui-form-label">登陆密码</label>
                <div class="layui-input-inline">
                    <input type="password" id="newPwd" name="password"   placeholder="请输入密码" autocomplete="off" class="layui-input">
                </div>
                <div class="layui-form-mid layui-word-aux"></div>
            </div>

            <div class="layui-form-item emp-hight" id="confirmPassword">
                <label class="layui-form-label">确认密码</label>
                <div class="layui-input-inline">
                    <input type="password" id="confirmPwd" name="confirmPassword"   placeholder="请输入密码" autocomplete="off" class="layui-input">
                </div>
            </div>

            <div class="layui-form-item">
                <div class="layui-input-block">
                    <button class="layui-btn" id="submitButton"  lay-submit lay-filter="SubmitButton">确定</button>
                </div>
            </div>

         </form>
    </div>
	<script src="/lib/layui/layui.js" charset="utf-8"></script>
    <script>
        layui.use(['form','layer','table'],function(){
            var form = layui.form,
                layer = parent.layer === undefined ? layui.layer : top.layer,
                $ = layui.jquery,
                table = layui.table;

            //添加验证规则
            form.verify({
                userAccunt:function(value, item){
                    if(!new RegExp("^[a-zA-Z0-9_\u4e00-\u9fa5\\s·]+$").test(value)){
                        return '用户名不能有特殊字符';
                    }
                    if(/(^\_)|(\__)|(\_+$)/.test(value)){
                        return '用户名首尾不能出现下划线\'_\'';
                    }
                    if(/^\d+\d+\d$/.test(value)){
                        return '用户名不能全为数字';
                    }
                },
                userName : function(value, item){
                    if(value.length > 10){
                        return "名字太长";
                      }
                },
                deptId:function(value, item){
                    if(value==''){
                        return "部门不能为空";
                    }
                },
                phone: [/^1[3|4|5|7|8]\d{9}$/, '请输入正确手机号！'],
                email: [/^[a-z0-9._%-]+@([a-z0-9-]+\.)+[a-z]{2,4}$|^1[3|4|5|7|8]\d{9}$/, '邮箱格式不对'],
                newPwd : function(value, item){
                    if(value.length < 6){
                        return "登陆密码长度不能小于6位";
                    }
                },
                confirmPwd : function(value, item){
                    if(!new RegExp($("#newPwd").val()).test(value)){
                        return "两次输入密码不一致，请重新输入！";
                    }
                }

            });

            $("#newPwd").on('blur',function(){
                var pwd = $('#newPwd').val();
                var ret = /^[a-zA-Z][a-zA-Z0-9_]{5,20}$/;
                if(ret.test(pwd)){
                }else {
                    layer.msg("密码请以字母开头，长度大于6！");
                   $("#submitButton").addClass("layui-btn-disabled");
                }
            });

            $("#confirmPwd").on('blur',function(){
                var pwd = $('#newPwd').val();
                var confirmPwd = $('#confirmPwd').val();
                if(pwd!=confirmPwd){
                    layer.msg("两次输入密码不一致，请重新输入！");
                    $("#submitButton").addClass("layui-btn-disabled");
                }else {
                    $("#submitButton").removeClass("layui-btn-disabled");
                }
            });

            //监听提交
            form.on('submit(SubmitButton)', function(data){
                var index = top.layer.msg('数据保存中，请稍候...',{icon: 16,time:false,shade:0.8});
                if ($("#id").val()==="") {
                    $.post("/employee/empUpdateOrAdd",data.field,function(res){
                        if (res.code=='0'){
                            layer.close(index);
                            layer.closeAll("iframe");
                            //刷新父页面
                            parent.location.reload();
                            layer.msg(res.msg);
                        } else {
                            layer.msg(res.msg);
                        }
                    })
                } else {
                    $.post("/employee/empUpdateOrAdd",data.field,function(res){
                        if (res.code=='0'){
                            layer.close(index);
                            layer.msg(res.msg);
                            layer.closeAll("iframe");
                            //刷新父页面
                            parent.location.reload();
                        } else {
                            layer.msg(res.msg);
                        }
                    })
                }
                return false;

            });

        });



    </script>
  </body>

</html>